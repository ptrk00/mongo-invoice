<!DOCTYPE html>
<html lang="en">

    <h1>Invoice Summary</h1>

    <h2>Total Invoices per Issuer</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Issuer ID</th>
                <th>Issuer Name</th>
                <th>Total Invoices</th>
            </tr>
        </thead>
        <tbody>
            <% if (invoiceSummary && invoiceSummary.length > 0) { %>
                <% invoiceSummary.forEach(function(entry) { %>
                    <tr>
                        <td><%= entry.issuerId %></td>
                        <td><%= entry.issuerName %></td>
                        <td><%= entry.totalInvoices %></td>
                    </tr>
                <% }); %>
            <% } else { %>
                <tr>
                    <td colspan="3" class="text-center">No data available</td>
                </tr>
            <% } %>
        </tbody>
    </table>
    
    <h2>Tax Collected by Jurisdiction</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Jurisdiction</th>
                <th>Total Tax Collected</th>
            </tr>
        </thead>
        <tbody>
            <% if (taxSummary && taxSummary.length > 0) { %>
                <% taxSummary.forEach(function(entry) { %>
                    <tr>
                        <td><%= entry.jurisdiction %></td>
                        <td><%= entry.totalTaxCollected %></td>
                    </tr>
                <% }); %>
            <% } else { %>
                <tr>
                    <td colspan="2" class="text-center">No data available</td>
                </tr>
            <% } %>
        </tbody>
    </table>
    
    <h2>Overdue Invoices</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Client ID</th>
                <th>Client Name</th>
                <th>Total Overdue Amount</th>
            </tr>
        </thead>
        <tbody>
            <% if (overdueInvoices && overdueInvoices.length > 0) { %>
                <% overdueInvoices.forEach(function(entry) { %>
                    <tr>
                        <td><%= entry._id %></td>
                        <td><%= entry.clientName %></td>
                        <td><%= entry.totalOverdueAmount %></td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Invoice Number</th>
                                        <th>Issue Date</th>
                                        <th>Due Date</th>
                                        <th>Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% entry.overdueInvoices.forEach(function(invoice) { %>
                                        <tr>
                                            <td><%= invoice.invoiceNumber %></td>
                                            <td><%= invoice.issueDate.toISOString().slice(0, 10) %></td>
                                            <td><%= invoice.dueDate.toISOString().slice(0, 10) %></td>
                                            <td><%= invoice.total %></td>
                                        </tr>
                                    <% }); %>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                <% }); %>
            <% } else { %>
                <tr>
                    <td colspan="3" class="text-center">No data available</td>
                </tr>
            <% } %>
        </tbody>
    </table>
    
    <h2>Monthly Revenue Breakdown</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Year</th>
                <th>Month</th>
                <th>Monthly Revenue</th>
            </tr>
        </thead>
        <tbody>
            <% if (monthlyRevenue && monthlyRevenue.length > 0) { %>
                <% monthlyRevenue.forEach(function(entry) { %>
                    <tr>
                        <td><%= entry._id.year %></td>
                        <td><%= entry._id.month %></td>
                        <td><%= entry.monthlyRevenue %></td>
                    </tr>
                <% }); %>
            <% } else { %>
                <tr>
                    <td colspan="3" class="text-center">No data available</td>
                </tr>
            <% } %>
        </tbody>
    </table>
</html>